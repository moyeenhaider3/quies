---
phase: 09-ux-polish-author
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - lib/presentation/widgets/shimmer/shimmer_line.dart
  - lib/presentation/widgets/shimmer/shimmer_circle.dart
  - lib/presentation/widgets/shimmer/shimmer_chip.dart
  - lib/presentation/widgets/shimmer/shimmer_bar.dart
  - lib/presentation/widgets/shimmer/shimmer_quote_card.dart
  - lib/features/quotes/presentation/pages/quote_feed_screen.dart
  - lib/features/quotes/presentation/pages/bookmarks_screen.dart
  - lib/features/quotes/presentation/widgets/tag_filter_sheet.dart
  - lib/features/music/presentation/pages/quote_music_screen.dart
  - lib/features/music/presentation/widgets/audio_player_widget.dart
  - lib/presentation/widgets/primary_button.dart
autonomous: true

must_haves:
  truths:
    - "No CircularProgressIndicator exists anywhere in the app"
    - "All loading states show shimmer skeletons that mimic real content layout"
    - "Shimmer adapts to dark/light theme automatically"
    - "Feed loading shows 1 full-screen shimmer card matching QuoteCard layout"
    - "Load-more indicator is a small shimmer bar, not a spinner"
  artifacts:
    - path: "lib/presentation/widgets/shimmer/shimmer_line.dart"
      provides: "Reusable shimmer text line primitive"
    - path: "lib/presentation/widgets/shimmer/shimmer_circle.dart"
      provides: "Reusable shimmer circle primitive"
    - path: "lib/presentation/widgets/shimmer/shimmer_chip.dart"
      provides: "Reusable shimmer tag chip primitive"
    - path: "lib/presentation/widgets/shimmer/shimmer_bar.dart"
      provides: "Small shimmer bar for load-more indicator"
    - path: "lib/presentation/widgets/shimmer/shimmer_quote_card.dart"
      provides: "Full card skeleton composing shimmer primitives"
  key_links:
    - from: "lib/features/quotes/presentation/pages/quote_feed_screen.dart"
      to: "lib/presentation/widgets/shimmer/shimmer_quote_card.dart"
      via: "import and use in FeedLoading state and isLoadingMore"
      pattern: "ShimmerQuoteCard|ShimmerBar"
    - from: "lib/presentation/widgets/shimmer/shimmer_line.dart"
      to: "flutter_animate"
      via: ".shimmer() extension method"
      pattern: "\\.shimmer\\("
---

<objective>
Create reusable shimmer skeleton primitives and replace ALL 7 CircularProgressIndicator instances with theme-aware shimmer loading states.

Purpose: Loading spinners are jarring in a meditative app. Shimmer skeletons that mimic real content layout create a smoother, more polished perception of loading.
Output: 5 new shimmer widgets + 7 files updated to remove all CircularProgressIndicator usage.
</objective>

<execution_context>
@.planning/phases/09-ux-polish-author/09-CONTEXT.md
@.planning/phases/09-ux-polish-author/09-RESEARCH.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

Key files to read before implementing:
@lib/features/quotes/presentation/pages/quote_feed_screen.dart (L246-248 FeedLoading, L322-337 isLoadingMore)
@lib/features/quotes/presentation/pages/bookmarks_screen.dart (L31 state is! FeedLoaded)
@lib/features/quotes/presentation/widgets/tag_filter_sheet.dart (L161 empty tags loading)
@lib/presentation/widgets/primary_button.dart (L47 isLoading)
@lib/features/music/presentation/pages/quote_music_screen.dart (L72 QuoteMusicLoading)
@lib/features/music/presentation/widgets/audio_player_widget.dart (L235 _isLoading)
@lib/features/quotes/presentation/widgets/quote_card.dart (reference for skeleton layout)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shimmer primitive widgets</name>
  <files>
    lib/presentation/widgets/shimmer/shimmer_line.dart
    lib/presentation/widgets/shimmer/shimmer_circle.dart
    lib/presentation/widgets/shimmer/shimmer_chip.dart
    lib/presentation/widgets/shimmer/shimmer_bar.dart
    lib/presentation/widgets/shimmer/shimmer_quote_card.dart
  </files>
  <action>
Create 5 shimmer widgets in `lib/presentation/widgets/shimmer/`:

**shimmer_line.dart** — `ShimmerLine` StatelessWidget:
- Parameters: `double width`, `double height` (default 16)
- Uses `Theme.of(context).brightness == Brightness.dark` to pick colors
- Dark base: `Color(0xFF2A2A3E)`, dark shimmer: `Color(0xFF3A3A4E)`
- Light base: `Color(0xFFE0E0E0)`, light shimmer: `Color(0xFFF0F0F0)`
- Container with rounded corners (4px radius), uses `.animate(onPlay: (c) => c.repeat()).shimmer(duration: 1200.ms, color: shimmerColor)`

**shimmer_circle.dart** — `ShimmerCircle` StatelessWidget:
- Parameters: `double size` (default 44)
- Same theme detection and color scheme as ShimmerLine
- Container with `BoxShape.circle`, same shimmer animation

**shimmer_chip.dart** — `ShimmerChip` StatelessWidget:
- Parameters: `double width` (default 60)
- Height: 24, borderRadius: 12
- Same theme detection, same shimmer animation

**shimmer_bar.dart** — `ShimmerBar` StatelessWidget:
- Parameters: `double width` (default 120), `double height` (default 4)
- Small horizontal bar for load-more indicator
- Centered, with borderRadius: 2
- Same shimmer animation

**shimmer_quote_card.dart** — `ShimmerQuoteCard` StatelessWidget:
- Composes the primitives to mimic QuoteCard layout:
  - 3 ShimmerLine (full-width, full-width, 200px) for quote text with 12px spacing
  - 1 ShimmerLine (140px wide, 14px height) for author
  - Row of 3 ShimmerChip (60, 75, 50 widths) for tags
  - Row of 4 ShimmerCircle (44px) with spaceEvenly for action buttons (matching Share/Like/Save + upcoming Author)
- Padding: 24px horizontal, centered vertically with Column + MainAxisAlignment.center
- Wrapped in a full-screen container (width/height: double.infinity) — NO gradient background (shimmer sits on existing card gradient or scaffold)
- All widgets import from `package:flutter_animate/flutter_animate.dart`
  </action>
  <verify>
Run `dart analyze lib/presentation/widgets/shimmer/` — no errors.
Confirm all 5 files exist and export their respective widget classes.
  </verify>
  <done>5 shimmer primitive widgets created, all compile cleanly, composable into full card skeleton</done>
</task>

<task type="auto">
  <name>Task 2: Replace all 7 CircularProgressIndicator instances with shimmer widgets</name>
  <files>
    lib/features/quotes/presentation/pages/quote_feed_screen.dart
    lib/features/quotes/presentation/pages/bookmarks_screen.dart
    lib/features/quotes/presentation/widgets/tag_filter_sheet.dart
    lib/features/music/presentation/pages/quote_music_screen.dart
    lib/features/music/presentation/widgets/audio_player_widget.dart
    lib/presentation/widgets/primary_button.dart
  </files>
  <action>
Replace each CircularProgressIndicator with the appropriate shimmer widget:

1. **quote_feed_screen.dart L246-248** — `FeedLoading` state:
   Replace `Center(child: CircularProgressIndicator())` with `const ShimmerQuoteCard()`.
   This is a full-screen loading state, shimmer card fills the space.

2. **quote_feed_screen.dart L322-337** — `isLoadingMore`:
   Replace the `SizedBox(width: 24, height: 24, child: CircularProgressIndicator(...))` with `const ShimmerBar(width: 120, height: 4)`.
   Keep the `Positioned` wrapper, keep `bottom: 16` and centering.

3. **bookmarks_screen.dart L31** — `state is! FeedLoaded`:
   Replace `Center(child: CircularProgressIndicator())` with `const Center(child: ShimmerQuoteCard())`.

4. **tag_filter_sheet.dart L161** — empty tags loading:
   Replace the `CircularProgressIndicator()` with a Column of 3 `ShimmerLine(width: double.infinity, height: 14)` with 8px spacing + a `ShimmerLine(width: 100, height: 14)`. Remove the "Loading tags..." text below.

5. **primary_button.dart L47** — `isLoading`:
   Replace `CircularProgressIndicator(strokeWidth: 2, ...)` with `ShimmerBar(width: 60, height: 4)`.
   Keep the `SizedBox(width: 20, height: 20, ...)` wrapper.

6. **quote_music_screen.dart L72** — `QuoteMusicLoading`:
   Replace `CircularProgressIndicator(color: AppTheme.calmTeal)` with `const ShimmerQuoteCard()`.
   Keep the container around it but remove the Column wrapper that held the spinner + text. Replace whole `_buildLoading` method body with just `const Center(child: ShimmerQuoteCard())`.

7. **audio_player_widget.dart L235** — `_isLoading` play button:
   Replace `CircularProgressIndicator(strokeWidth: 2, color: AppTheme.calmTeal)` with `const ShimmerCircle(size: 44)`.
   Remove the `Padding(padding: EdgeInsets.all(10), ...)` wrapper since ShimmerCircle handles its own sizing.

Add imports for shimmer widgets at top of each modified file:
`import 'package:quies/presentation/widgets/shimmer/shimmer_quote_card.dart';`
(and the specific primitives as needed)
  </action>
  <verify>
Run `dart analyze lib/` — no errors.
Run `grep -rn "CircularProgressIndicator" lib/` — should return ZERO matches.
  </verify>
  <done>All 7 CircularProgressIndicator instances replaced. grep confirms zero remaining spinners in lib/.</done>
</task>

</tasks>

<verification>
1. `dart analyze lib/` passes with no errors
2. `grep -rn "CircularProgressIndicator" lib/` returns zero results
3. 5 new shimmer files exist in `lib/presentation/widgets/shimmer/`
4. Each shimmer widget uses theme-aware colors (dark: #2A2A3E/#3A3A4E, light: #E0E0E0/#F0F0F0)
5. ShimmerQuoteCard layout mirrors QuoteCard structure (text lines, author, tags, action buttons)
</verification>

<success_criteria>
- Zero `CircularProgressIndicator` anywhere in the codebase
- All loading states use shimmer skeletons matching content layout
- Shimmer auto-adapts to dark/light theme
- `dart analyze` clean
</success_criteria>

<output>
After completion, create `.planning/phases/09-ux-polish-author/09-01-SUMMARY.md`
</output>
